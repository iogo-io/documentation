# Endpoints

[iogo](https://iogo.io) is a standards-compliant OAuth 2.0 authorization server and an OpenID Connect (OIDC) 1.0 provider.

This document contains the list of OAuth 2.0 and OIDC endpoints exposed on the authorization server.

## OpenID Connect Discovery Document

The discovery document (`https://oidc.iogo.io/.well-known/openid-configuration`) includes a set of claims about the OIDC provider configuration, including all necessary endpoints and public key location information. It can, and should, be used to automatically configure apps.

## Base URL

Base URL of the authorization server is: `https://oidc.iogo.io`.

## Common Endpoints

| Endpoint                                    | Path                | Description                                                                                                             |
| ------------------------------------------- | ------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| [Authorization](#authorization)             | `/authorize`        | Used to interact with the resource owner and obtain an authorization grant.                                             |
| [Token](#token)                             | `/token`            | Used to obtain an access token.                                                                                         |
| [Token Introspection](#token-introspection) | `/token/introspect` | Used to determine the active state of a token and to determine meta-information about the token.                        |
| [Token Revocation](#token-revocation)       | `/token/revoke`     | Used to notify the authorization server that a previously obtained token is no longer needed.                           |
| [JWKS](#jwks)                               | `/jwks`             | Used to return a JSON Web Key Set (JWKS) that contains public keys that can be used to verify the signature of a token. |
| [UserInfo](#userinfo)                       | `/userinfo`         | Used to return claims about the resource owner.                                                                         |
| [Session End](#session-end)                 | `/session/end`      | Used to sign out the resource owner.                                                                                    |

### Authorization

`GET` `/authorize`

#### Request

```
GET /authorize?
    client_id=CLIENT_ID&
    redirect_uri=REDIRECT_URI&
    response_type=code&
    scope=openid email&
    state=STATE HTTP/1.1
Host: oidc.iogo.io
```

#### Parameters

| Parameter       | Description                                                                                | Requisite   |
| --------------- | ------------------------------------------------------------------------------------------ | ----------- |
| `client_id`     | The client identifier.                                                                     | Required    |
| `redirect_uri`  | The client's redirection endpoint.                                                         | Required    |
| `response_type` | Value must be set to `code`.                                                               | Required    |
| `scope`         | The scope of the access request. Value must be set to `openid`, `email`, or `openid email` | Required    |
| `state`         | An opaque value used by the client to maintain state between the request and response.     | Recommended |

#### Response

```
HTTP/1.1 302 Found
Location: https://REDIRECT_URI/?code=CODE&state=STATE
```

#### Parameters

| Parameter | Description                                                   | Requisite   |
| --------- | ------------------------------------------------------------- | ----------- |
| `code`    | The authorization code generated by the authorization server. | Required    |
| `state`   | The exact value received from the client.                     | Required \* |

\* If the `state` parameter was present in the client authorization request.

#### Errors

```
HTTP/1.1 302 Found
Location: https://REDIRECT_URI/?error=ERROR&state=STATE
```

#### Parameters

| Parameter           | Description                                                    | Requisite   |
| ------------------- | -------------------------------------------------------------- | ----------- |
| `error`             | An error code.                                                 | Required    |
| `error_description` | A human-readable description of the error.                     | Optional    |
| `error_uri`         | An URI containing the human-readable description of the error. | Optional    |
| `state`             | The exact value received from the client.                      | Required \* |

\* If the `state` parameter was present in the client authorization request.

#### Error Codes

##### OAuth 2.0 Error Codes

| Error Code                  | Description                                                                                                                                       |
| --------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------- |
| `access_denied`             | The resource owner or the authorization server denied the request.                                                                                |
| `invalid_request`           | The request is missing a required parameter, includes an invalid parameter value, includes a parameter more than once, or is otherwise malformed. |
| `invalid_scope`             | The requested scope is invalid, unknown, or malformed.                                                                                            |
| `server_error`              | The authorization server encountered an unexpected condition that prevented it from fulfilling the request.                                       |
| `temporarily_unavailable`   | The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server.                   |
| `unauthorized_client`       | The client is not authorized to request an authorization code using this method.                                                                  |
| `unsupported_response_type` | The authorization server does not support obtaining an authorization code using this method.                                                      |

##### OpenID Connect 1.0 Error Codes

| Error Code                   | Description                                                                               |
| ---------------------------- | ----------------------------------------------------------------------------------------- |
| `account_selection_required` | The resource owner is required to select a session at the authorization server.           |
| `consent_required`           | The authorization server requires resource owner consent.                                 |
| `interaction_required`       | The authorization server requires resource owner interaction of some form to proceed.     |
| `invalid_request_uri`        | The `request_uri` in the authorization request returns an error or contains invalid data. |
| `invalid_request_object`     | The `request` parameter contains an invalid request object.                               |
| `login_required`             | The authorization server requires resource owner authentication.                          |
| `registration_not_supported` | The OpenID Connect provider does not support use of the `registration` parameter.         |
| `request_not_supported`      | The OpenID Connect provider does not support use of the `request` parameter.              |
| `request_uri_not_supported`  | The OpenID Connect provider does not support use of the `request_uri` parameter.          |

<!--
- [Authorization Request](https://tools.ietf.org/html/rfc6749#section-4.1.1)
- [Authorization Response](https://tools.ietf.org/html/rfc6749#section-4.1.2)
- [Error Response](https://tools.ietf.org/html/rfc6749#section-4.1.2.1)

* [Authentication Request](https://openid.net/specs/openid-connect-core-1_0.html#AuthRequest)
* [Authentication Response](https://openid.net/specs/openid-connect-core-1_0.html#AuthResponse)
* [Error Response](https://openid.net/specs/openid-connect-core-1_0.html#AuthError)
-->

### Token

`POST` `/token`

#### Request

```
POST /token HTTP/1.1
Host: oidc.iogo.io
Authorization: Basic BASE64_ENCODED_CREDENTIALS
Content-Type: application/x-www-form-urlencoded

code=CODE&
grant_type=authorization_code&
redirect_uri=REDIRECT_URI
```

#### Parameters

| Parameter      | Description                                                    | Requisite |
| -------------- | -------------------------------------------------------------- | --------- |
| `code`         | The authorization code received from the authorization server. | Required  |
| `grant_type`   | Value must be set to `authorization_code`.                     | Required  |
| `redirect_uri` | The client's redirection endpoint.                             | Required  |

> Some endpoints require client authentication. To make requests to these endpoints, you must include an authentication header or a parameter in the request depending on the type of a client.
>
> For confidential clients (web apps), authenticate a client with the Base64-encoded `client_id` and `client_secret` pair using the Basic HTTP authentication scheme.
>
> For public clients (native and single-page apps), provide the `client_id` parameter in the POST request.

#### Response

```
HTTP/1.1 200 OK
Content-Type: application/json

{
    "access_token": ACCESS_TOKEN,
    "expires_in": 3600,
    "id_token": ID_TOKEN,
    "scope": SCOPE,
    "token_type": "Bearer"
}
```

#### Properties

| Property       | Description                                              | Requisite   |
| -------------- | -------------------------------------------------------- | ----------- |
| `access_token` | The access token issued by the authorization server.     | Required    |
| `expires_in`   | The lifetime in seconds of the access token.             | Recommended |
| `id_token`     | The ID token. Returned if the `openid` scope is granted. | Required    |
| `scope`        | The scope of the access request.                         | Optional \* |
| `token_type`   | The type of the token issued.                            | Required    |

\* If identical to the scope requested by the client; otherwise, required.

#### Errors

```
HTTP/1.1 400 Bad Request
Content-Type: application/json

{
    "error": ERROR_CODE
}
```

#### Parameters

| Parameter           | Description                                                    | Requisite |
| ------------------- | -------------------------------------------------------------- | --------- |
| `error`             | An error code.                                                 | Required  |
| `error_description` | A human-readable description of the error.                     | Optional  |
| `error_uri`         | An URI containing the human-readable description of the error. | Optional  |

#### Error Codes

| Error Code               | Description                                                                                                                                                                                                                                                  |
| ------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `invalid_client`         | The client authentication failed (e.g., unknown client, no client authentication included, or unsupported authentication method).                                                                                                                            |
| `invalid_grant`          | The provided authorization grant (e.g., authorization code, resource owner credentials) or refresh token is invalid, expired, revoked, does not match the redirection URI used in the authorization request, or was issued to another client.                |
| `invalid_request`        | The request is missing a required parameter, includes an unsupported parameter value (other than grant type), repeats a parameter, includes multiple credentials, utilizes more than one mechanism for authenticating the client, or is otherwise malformed. |
| `invalid_scope`          | The requested scope is invalid, unknown, malformed, or exceeds the scope granted by the resource owner.                                                                                                                                                      |
| `unauthorized_client`    | The authenticated client is not authorized to use this authorization grant type.                                                                                                                                                                             |
| `unsupported_grant_type` | The authorization grant type is not supported by the authorization server.                                                                                                                                                                                   |

<!--
- [Access Token Request](https://tools.ietf.org/html/rfc6749#section-4.1.3)
- [Access Token Response](https://tools.ietf.org/html/rfc6749#section-4.1.4)
- [Error Response](https://tools.ietf.org/html/rfc6749#section-5.2)

* [Token Request](https://openid.net/specs/openid-connect-core-1_0.html#TokenRequest)
* [Token Response](https://openid.net/specs/openid-connect-core-1_0.html#TokenResponse)
* [Error Response](https://openid.net/specs/openid-connect-core-1_0.html#TokenErrorResponse)
-->

### Token Introspection

`POST` `/token/introspect`

#### Request

```
POST /token/introspect HTTP/1.1
Host: oidc.iogo.io
Content-Type: application/x-www-form-urlencoded
Authorization: Basic BASE64_ENCODED_CREDENTIALS

token=TOKEN&
token_type_hint=access_token
```

#### Parameters

| Parameter         | Description                                                                                                          | Requisite |
| ----------------- | -------------------------------------------------------------------------------------------------------------------- | --------- |
| `token`           | The token that the client wants to get revoked.                                                                      | Required  |
| `token_type_hint` | A hint about the type of the token submitted for revocation. Value must be set to `access_token` or `refresh_token`. | Optional  |

> Some endpoints require client authentication. To make requests to these endpoints, you must include an authentication header or a parameter in the request depending on the type of a client.
>
> For confidential clients (web apps), authenticate a client with the Base64-encoded `client_id` and `client_secret` pair using the Basic HTTP authentication scheme.
>
> For public clients (native and single-page apps), provide the `client_id` parameter in the POST request.

#### Response

```
HTTP/1.1 200 OK
Content-Type: application/json

{
    "active": true,
    "aud": AUD,
    "client_id": CLIENT_ID,
    "exp": EXP,
    "iat": IAT,
    "iss": ISS,
    "sub": SUB
}
```

#### Properties

| Property    | Description                                                                                                                                                                                                                                                                        | Requisite |
| ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------- |
| `active`    | A boolean indicator of whether or not the presented token is currently active. A `true` value will generally indicate that a given token has been issued by this authorization server, has not been revoked by the resource owner, and is within its given time window of validity | Required  |
| `aud`       | The intended audience for the token.                                                                                                                                                                                                                                               | Optional  |
| `client_id` | The client identifier.                                                                                                                                                                                                                                                             | Optional  |
| `exp`       | An integer time-stamp, measured in the number of seconds since January 1 1970 UTC, indicating when the token will expire.                                                                                                                                                          | Optional  |
| `iat`       | An integer time-stamp, measured in the number of seconds since January 1 1970 UTC, indicating when the token was originally issued.                                                                                                                                                | Optional  |
| `iss`       | The issuer of the token.                                                                                                                                                                                                                                                           | Optional  |
| `sub`       | The subject of the token.                                                                                                                                                                                                                                                          | Optional  |

#### Errors

```
HTTP/1.1 400 Bad Request
Content-Type: application/json

{
    "error": ERROR_CODE
}
```

#### Parameters

| Parameter           | Description                                                    | Requisite |
| ------------------- | -------------------------------------------------------------- | --------- |
| `error`             | An error code.                                                 | Required  |
| `error_description` | A human-readable description of the error.                     | Optional  |
| `error_uri`         | An URI containing the human-readable description of the error. | Optional  |

#### Error Codes

| Error Code               | Description                                                                                                                                                                                                                                                  |
| ------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `invalid_client`         | The client authentication failed (e.g., unknown client, no client authentication included, or unsupported authentication method).                                                                                                                            |
| `invalid_grant`          | The provided authorization grant (e.g., authorization code, resource owner credentials) or refresh token is invalid, expired, revoked, does not match the redirection URI used in the authorization request, or was issued to another client.                |
| `invalid_request`        | The request is missing a required parameter, includes an unsupported parameter value (other than grant type), repeats a parameter, includes multiple credentials, utilizes more than one mechanism for authenticating the client, or is otherwise malformed. |
| `invalid_scope`          | The requested scope is invalid, unknown, malformed, or exceeds the scope granted by the resource owner.                                                                                                                                                      |
| `unauthorized_client`    | The authenticated client is not authorized to use this authorization grant type.                                                                                                                                                                             |
| `unsupported_grant_type` | The authorization grant type is not supported by the authorization server.                                                                                                                                                                                   |

<!--
- [Introspection Request](https://tools.ietf.org/html/rfc7662#section-2.1)
- [Introspection Response](https://tools.ietf.org/html/rfc7662#section-2.2)
- [Error Response](https://tools.ietf.org/html/rfc7662#section-2.3)
-->

### Token Revocation

`POST` `/token/revoke`

#### Request

```
POST /token/revoke HTTP/1.1
Host: oidc.iogo.io
Content-Type: application/x-www-form-urlencoded
Authorization: Basic BASE64_ENCODED_CREDENTIALS

token=TOKEN&
token_type_hint=refresh_token
```

#### Parameters

| Parameter         | Description                                                                                                          | Requisite |
| ----------------- | -------------------------------------------------------------------------------------------------------------------- | --------- |
| `token`           | The token that the client wants to get revoked.                                                                      | Required  |
| `token_type_hint` | A hint about the type of the token submitted for revocation. Value must be set to `access_token` or `refresh_token`. | Optional  |

> Some endpoints require client authentication. To make requests to these endpoints, you must include an authentication header or a parameter in the request depending on the type of a client.
>
> For confidential clients (web apps), authenticate a client with the Base64-encoded `client_id` and `client_secret` pair using the Basic HTTP authentication scheme.
>
> For public clients (native and single-page apps), provide the `client_id` parameter in the POST request.

#### Response

```
HTTP/1.1 200 OK
```

#### Errors

```
HTTP/1.1 400 Bad Request
Content-Type: application/json

{
    "error": ERROR_CODE
}
```

#### Parameters

| Parameter           | Description                                                    | Requisite |
| ------------------- | -------------------------------------------------------------- | --------- |
| `error`             | An error code.                                                 | Required  |
| `error_description` | A human-readable description of the error.                     | Optional  |
| `error_uri`         | An URI containing the human-readable description of the error. | Optional  |

#### Error Codes

| Error Code               | Description                                                                                                                                                                                                                                                  |
| ------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `invalid_client`         | The client authentication failed (e.g., unknown client, no client authentication included, or unsupported authentication method).                                                                                                                            |
| `invalid_grant`          | The provided authorization grant (e.g., authorization code, resource owner credentials) or refresh token is invalid, expired, revoked, does not match the redirection URI used in the authorization request, or was issued to another client.                |
| `invalid_request`        | The request is missing a required parameter, includes an unsupported parameter value (other than grant type), repeats a parameter, includes multiple credentials, utilizes more than one mechanism for authenticating the client, or is otherwise malformed. |
| `invalid_scope`          | The requested scope is invalid, unknown, malformed, or exceeds the scope granted by the resource owner.                                                                                                                                                      |
| `unauthorized_client`    | The authenticated client is not authorized to use this authorization grant type.                                                                                                                                                                             |
| `unsupported_grant_type` | The authorization grant type is not supported by the authorization server.                                                                                                                                                                                   |
| `unsupported_token_type` | The authorization server does not support the revocation of the presented token type.                                                                                                                                                                        |

<!--
- [Revocation Request](https://tools.ietf.org/html/rfc7009#section-2.1)
- [Revocation Response](https://tools.ietf.org/html/rfc7009#section-2.2)
- [Error Response](https://tools.ietf.org/html/rfc7009#section-2.2.1)
-->

### JWKS

`GET` `/jwks`

#### Request

```
GET /jwks HTTP/1.1
Host: oidc.iogo.io
```

#### Response

```
HTTP/1.1 200 OK
Content-Type: application/json

{
    "keys": [
        {
            "crv": "P-256",
            "kid": "8SASJkc4bxi4i3jBoVeoBjatDOzNYN1cJCAkwTVnqR0",
            "kty": "EC",
            "use": "sig",
            "x": "-NKrJhNrL9H3gzRkzdPkYbUBbmIFavnmdRn6TNT6Rfk",
            "y": "fxB3pFpush_29Kjnq20V4VXpA92R4qqGmZ19mVICxrw"
        },
        {
            "crv": "P-256",
            "kid": "tJnj1mf-H1LEEXudTeCMPwOZ31hZygvhQIIdKFPAIFM",
            "kty": "EC",
            "use": "enc",
            "x": "d5GLRFPus_b0CBfcUYgM08b2DX16629HCmlUwSHrcQw",
            "y": "ZreNmXiW_V9deMSS251y79Tlmbt-rg2sd2E23TFNBOE"
        },
        {
            "e": "AQAB",
            "kid": "vIk0NU95aEXC0OAgbLqMT52BLayXBoHFDuohUAHiRcM",
            "kty": "RSA",
            "n": "ruFtDC0eUwShoDrrQIOsjFZw98h2RJ9rDe1EuQMGtbyKTdJfMmsTfXvz6sLKDYQgVQ2AEiXsj8rAYpBgxjfDtPEfG9glGX6WJKo9yWJCZMSkmefzW95SvOTek-uEIRcOAnIDKU_qv5IS6oMima-dLabMvGVdaF1aVwh2VwmIqAuW6vYrTPjE8o0EfGj0sZOHGKEA43gz_auFBMa3WOV0p9Yj18KtUowrq83FQkRx-UzL6VMSJBers_3YlnPXtJRCkCU_GDlQKMp8FWZPU1yjydbgINf8SLtai3ghr2-By38zBmoVuJGqQ2Q6I_-WEWjMb84AbWgEEb0ExN2FV6eAyw",
            "use": "sig"
        },
        {
            "e": "AQAB",
            "kid": "-AqkRp-j33tetP1-qNWyEUouXTeu0VRwu9pZkPFD20k",
            "kty": "RSA",
            "n": "xyH4McpilN3XgS9bL5gU9R2bpq5S43e0lSGH1QXf4grkeJ61OfbA-sQKBVSBBBex1jC85u7aiabxv1mcMl86Zw8h9NQVtyRB3hCzC9tTTGyHvJEgfTQ-ffmkZAiVIR7XlgwnODLjpIuKYGNbwoy_oEps6lFg7dzMr0mxu17f3DUbOiD3x06nq-jF0d66ZBBWmODENQax6Z2x9XxFYmDNtExvv1kC2BQb5RkX_7SUpbDsamYTH6HwzgeOOOItUfj-aGAzVbigCURVRIL836K4xdWZsG4vZNaTPhvtVgaaw_schgxAQ_gyvEr4QN89LEo9HRw_ou_Jfp7jRnzLEhxhgw",
            "use": "enc"
        }
    ]
}
```

#### Properties

| Property | Description                                                                                                                          |
| -------- | ------------------------------------------------------------------------------------------------------------------------------------ |
| `crv`    | The `crv` property identifies the cryptographic curve used with the key, such as `P-256`.                                            |
| `e`      | The `e` property contains the RSA public key exponent.                                                                               |
| `kid`    | The `kid` (key ID) property is used to match a specific key.                                                                         |
| `kty`    | The `kty` (key type) property identifies the cryptographic algorithm family used with the key, such as `RSA` or `EC`.                |
| `n`      | The `n` property contains the RSA public key modulus.                                                                                |
| `use`    | The `use` (public key use) property identifies the intended use of the public key, such as `sig` (signature) and `end` (encryption). |
| `x`      | The `x` property contains the x coordinate for the elliptic curve point.                                                             |
| `y`      | The `y` property contains the y coordinate for the elliptic curve point.                                                             |

<!-- - [JWKS](https://tools.ietf.org/html/rfc7517) -->

### UserInfo

`GET` `/userinfo`

#### Request

```
GET /userinfo HTTP/1.1
Host: oidc.iogo.io
Authorization: Bearer ACCESS_TOKEN
```

#### Response

```
HTTP/1.1 200 OK
Content-Type: application/json

{
    "sub": SUB,
    "email": EMAIL,
    "email_verified": true
}
```

#### Properties

| Property         | Description                                                                                     | Requisite |
| ---------------- | ----------------------------------------------------------------------------------------------- | --------- |
| `sub`            | The `sub` (subject) claim identifies the resource owner.                                        | Required  |
| `email`          | The `email` claim identifies the resource owner's e-mail address.                               | Optional  |
| `email_verified` | The `email_verified` claim identifies if the resource owner's e-mail address has been verified. | Optional  |

#### Errors

```
HTTP/1.1 400 Bad Request
Content-Type: application/json

{
    "error": ERROR_CODE
}
```

#### Parameters

| Parameter           | Description                                                    | Requisite |
| ------------------- | -------------------------------------------------------------- | --------- |
| `error`             | An error code.                                                 | Required  |
| `error_description` | A human-readable description of the error.                     | Optional  |
| `error_uri`         | An URI containing the human-readable description of the error. | Optional  |

#### Error Codes

| Error Code           | Description                                                                                                                                                  |
| -------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `insufficient_scope` | The request requires higher privileges than provided by the access token. HTTP 403 (Forbidden) status code will be returned for this error.                  |
| `invalid_request`    | The request is missing a required parameter, includes an invalid parameter value, includes a parameter more than once, or is otherwise malformed.            |
| `invalid_token`      | The access token provided is expired, revoked, malformed, or invalid for other reasons. HTTP 401 (Unauthorized) status code will be returned for this error. |

<!--
- [UserInfo Request](https://openid.net/specs/openid-connect-core-1_0.html#UserInfoRequest)
- [UserInfo Response](https://openid.net/specs/openid-connect-core-1_0.html#UserInfoResponse)
- [Error Response](https://openid.net/specs/openid-connect-core-1_0.html#UserInfoError)
-->

### Session End

`GET` `/session/end`

#### Request

```
GET /session/end?
    id_token_hint=ID_TOKEN HTTP/1.1
Host: oidc.iogo.io
```

#### Parameters

| Parameter       | Description                                | Requisite |
| --------------- | ------------------------------------------ | --------- |
| `id_token_hint` | The ID token matching the current session. | Required  |

#### Response

```
HTTP/1.1 200 OK
```

#### Errors

```
HTTP/1.1 400 Bad Request
Content-Type: application/json

{
    "error": ERROR_CODE
}
```

#### Parameters

| Parameter           | Description                                                    | Requisite |
| ------------------- | -------------------------------------------------------------- | --------- |
| `error`             | An error code.                                                 | Required  |
| `error_description` | A human-readable description of the error.                     | Optional  |
| `error_uri`         | An URI containing the human-readable description of the error. | Optional  |

#### Error Codes

| Error Code        | Description                                                                                                                                                                                                                                                  |
| ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `invalid_request` | The request is missing a required parameter, includes an unsupported parameter value (other than grant type), repeats a parameter, includes multiple credentials, utilizes more than one mechanism for authenticating the client, or is otherwise malformed. |

<!-- [Session Management](https://openid.net/specs/openid-connect-session-1_0.html) -->
